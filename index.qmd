---
title: "jsPsych Github Workflow"
format:
  html:
    code-fold: true
jupyter: python3
---

Hello, this page will showcase the main dashboard!

```{python}
#Initializing Workspace
import requests
import datetime
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

#API Function
def fetch_api(endpoint):
 url = f"https://api.github.com/repos/jspsych/jsPsych/{endpoint}"
 final_data=[]
 while url:
  response = requests.get(url)
  data = response.json()
  for item in data:
    final_data.append(item)
  if 'next' in response.links:
    url = response.links['next']['url']
  else:
    break

  return final_data

#Dataframe
def create_ent_dataframe(ent_type):
  is_pr = 'pulls=true' if ent_type == 'pulls' else 'pulls=false'
  ret_data = fetch_api(f"issues?{is_pr}&state=all&per_page=100")
  entries = []
  for item in ret_data:
    print(f"ITEM TYPE: {type(item)}")
    entry = {
    'number': item['number'],
    'user': item['user']['login'],
    'created_at': pd.to_datetime(item['created_at']),
    'closed_at': pd.to_datetime(item['closed_at']) if item['closed_at'] else None,
    'state': item['state'],
    'title': item['title'],
    'is_pr': 'pull_request' in item
    }
  entries.append(entry)
  df = pd.DataFrame(entries)
  df['year'] = df['created_at'].dt.year
  df['quarter'] = df['created_at'].dt.quarter

  return df
```
